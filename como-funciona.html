<!DOCTYPE html>
<html lang="pt-BR" class="scroll-smooth">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Como Funciona | Boutique Method</title>
    <link rel="icon" href="favicon.ico" type="image/x-icon" />

    <link rel="stylesheet" href="accessibility.css" />

    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&family=Playfair+Display:ital,wght@0,400;0,500;0,600;1,400&display=swap" rel="stylesheet">

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: { serif: ['"Playfair Display"', 'serif'], sans: ['"Lato"', 'sans-serif'] },
                    colors: {
                        gold: {
                            300: '#e5c55b',
                            400: '#d4af37',
                            500: '#b5922f',
                            900: '#8a6d1f'
                        },
                        obsidian: '#050505',
                        charcoal: '#0a0a0a'
                    },
                    backgroundImage: {
                        'lux-gradient': 'radial-gradient(circle at center top, rgba(20,20,20,1) 0%, rgba(5,5,5,1) 60%)',
                    },
                    animation: {
                        'fade-up': 'fadeUp 1s ease-out forwards',
                    },
                    keyframes: {
                        fadeUp: {
                            '0%': { opacity: '0', transform: 'translateY(20px)' },
                            '100%': { opacity: '1', transform: 'translateY(0)' },
                        }
                    }
                }
            }
        }
    </script>

    <style>
        :root { --nav-offset: 100px; }

        body {
            background-color: #020202;
            color: #e5e5e5;
            font-family: 'Lato', sans-serif;
            overflow-x: hidden;
        }

        ::selection { background: rgba(212, 175, 55, 0.2); color: #d4af37; }

        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-track { background: #000; }
        ::-webkit-scrollbar-thumb { background: #333; border-radius: 3px; }
        ::-webkit-scrollbar-thumb:hover { background: #d4af37; }

        main { padding-top: var(--nav-offset); }
        #main-content { scroll-margin-top: var(--nav-offset); }

        :focus-visible {
            outline: 1px solid #d4af37;
            outline-offset: 4px;
            box-shadow: 0 0 15px rgba(212,175,55,0.18);
        }

        .glass-panel {
            background: rgba(255, 255, 255, 0.02);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.05);
            transition: all 0.5s ease;
        }
        .glass-panel:hover {
            border-color: rgba(212, 175, 55, 0.3);
            background: rgba(255, 255, 255, 0.04);
            transform: translateY(-2px);
            box-shadow: 0 10px 40px rgba(0,0,0,0.5);
        }

        .roadmap-container { position: relative; }
        .roadmap-line {
            position: absolute; left: 50%; top: 0; bottom: 0; width: 1px;
            background: linear-gradient(to bottom, transparent, rgba(212, 175, 55, 0.4), transparent);
            transform: translateX(-50%);
        }
        @media (max-width: 768px) { .roadmap-line { left: 24px; transform: none; } }

        .step-number-badge {
            font-family: 'Playfair Display', serif;
            font-style: italic;
            color: #d4af37;
            font-size: 1.1rem;
            width: 48px;
            height: 48px;
            display: flex;
            align-items: center;
            justify-content: center;
            border: 1px solid rgba(212, 175, 55, 0.4);
            background: #050505;
            z-index: 10;
            border-radius: 50%;
            box-shadow: 0 0 20px rgba(0,0,0,0.8);
            transition: 0.3s;
        }
        .step-group:hover .step-number-badge {
            background: #d4af37;
            color: #000;
            border-color: #d4af37;
            box-shadow: 0 0 25px rgba(212, 175, 55, 0.4);
        }

        /* CTA discreto dentro do card */
        .step-cta {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            margin-top: 18px;
            font-size: 10px;
            letter-spacing: 0.25em;
            text-transform: uppercase;
            color: rgba(212,175,55,0.9);
            transition: 0.35s;
        }
        .step-card:hover .step-cta { color: #fff; }
        .step-card:hover .step-cta .step-cta-line { width: 34px; background: rgba(212,175,55,0.85); }
        .step-cta-line { width: 18px; height: 1px; background: rgba(255,255,255,0.15); transition: 0.35s; }

        /* Modal */
        .modal-enter { animation: fadeIn 0.35s cubic-bezier(0.4, 0, 0.2, 1) forwards; }
        @keyframes fadeIn { from { opacity: 0; transform: scale(0.985); } to { opacity: 1; transform: scale(1); } }

        .audio-fab {
            position: fixed; bottom: 40px; right: 40px; z-index: 100;
            background: rgba(10, 10, 10, 0.6);
            backdrop-filter: blur(8px);
            -webkit-backdrop-filter: blur(8px);
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: 4px;
            padding: 14px 28px;
            display: flex; align-items: center; gap: 12px;
            cursor: pointer; transition: all 0.5s ease;
        }
        .audio-fab:hover { background: rgba(212, 175, 55, 0.1); border-color: rgba(212, 175, 55, 0.4); }
        .audio-wave { display: flex; gap: 3px; align-items: center; height: 12px; }
        .bar { width: 1px; background: #d4af37; animation: wave 1s infinite ease-in-out; }
        .bar:nth-child(1) { height: 60%; animation-delay: 0s; }
        .bar:nth-child(2) { height: 100%; animation-delay: 0.1s; }
        .bar:nth-child(3) { height: 50%; animation-delay: 0.2s; }
        .paused .bar { animation: none; height: 2px; opacity: 0.5; }
        @keyframes wave { 0%, 100% { height: 30%; } 50% { height: 100%; } }

        .drawer-enter { animation: drawerIn 0.35s cubic-bezier(0.4, 0, 0.2, 1) forwards; }
        @keyframes drawerIn { from { transform: translateX(12px); opacity: 0.7; } to { transform: translateX(0); opacity: 1; } }

        @media (max-width: 640px) {
            .audio-fab { bottom: 16px; right: 16px; padding: 12px 20px; }
        }
    </style>
</head>

<body class="antialiased flex flex-col min-h-screen bg-obsidian bg-lux-gradient bg-fixed">

    <a href="#main-content" class="skip-link sr-only focus:not-sr-only focus:absolute focus:top-4 focus:left-4 focus:bg-gold-400 focus:text-black focus:p-2 focus:z-[120]">Pular para o conteúdo</a>

    <!-- NAV (PADRÃO + MOBILE) -->
    <nav class="fixed w-full z-50 bg-black/60 backdrop-blur-xl border-b border-white/[0.03] transition-all duration-500">
        <div class="max-w-[1400px] mx-auto px-6 h-24 flex items-center justify-between">

            <a href="index.html" class="group flex items-center gap-4 opacity-90 hover:opacity-100 transition duration-500" aria-label="Boutique Method - Página inicial">
                <img src="bmip-logo-dark.png" alt="Boutique Method IP Holding" class="h-10 w-auto opacity-90 group-hover:brightness-110 transition duration-500">
                <div class="flex flex-col">
                    <span class="font-serif text-lg tracking-[0.15em] text-white uppercase leading-none">
                        Boutique Method<span class="text-gold-400 text-[0.6em] align-top ml-1">®</span>
                    </span>
                </div>
            </a>

            <!-- Desktop NAV -->
            <div class="hidden lg:flex items-center gap-10">
                <div class="flex gap-8 text-[11px] tracking-[0.25em] uppercase font-light text-neutral-400">
                    <a href="index.html" class="hover:text-gold-400 transition duration-300 relative group">Início<span class="absolute -bottom-2 left-0 w-0 h-[1px] bg-gold-400 transition-all duration-300 group-hover:w-full"></span></a>
                    <a href="origem.html" class="hover:text-gold-400 transition duration-300 relative group">Origem<span class="absolute -bottom-2 left-0 w-0 h-[1px] bg-gold-400 transition-all duration-300 group-hover:w-full"></span></a>
                    <a href="manifesto.html" class="hover:text-gold-400 transition duration-300 relative group">Manifesto<span class="absolute -bottom-2 left-0 w-0 h-[1px] bg-gold-400 transition-all duration-300 group-hover:w-full"></span></a>

                    <!-- Como Funciona é página satélite → destacamos Licenciamento -->
                    <a href="licenciamento.html" class="text-gold-400 relative group cursor-default">Licenciamento<span class="absolute -bottom-2 left-0 w-full h-[1px] bg-gold-400"></span></a>

                    <a href="projetos-consultoria.html" class="hover:text-gold-400 transition duration-300 relative group">Projetos &amp; Consultoria<span class="absolute -bottom-2 left-0 w-0 h-[1px] bg-gold-400 transition-all duration-300 group-hover:w-full"></span></a>
                    <a href="acervo-executivo.html" class="hover:text-gold-400 transition duration-300 relative group">Acervo Executivo<span class="absolute -bottom-2 left-0 w-0 h-[1px] bg-gold-400 transition-all duration-300 group-hover:w-full"></span></a>
                    <a href="iniciar-tratativas.html" class="hover:text-gold-400 transition duration-300 relative group">Contato<span class="absolute -bottom-2 left-0 w-0 h-[1px] bg-gold-400 transition-all duration-300 group-hover:w-full"></span></a>
                </div>

                <div class="h-4 w-px bg-white/10"></div>

                <div class="flex items-center gap-3 text-[10px] uppercase tracking-widest">
                    <span class="text-gold-400">PT</span>
                    <a href="como-funciona-en.html" class="text-neutral-600 hover:text-white transition" lang="en">EN</a>
                </div>

                <a href="iniciar-tratativas.html" class="px-8 py-3 border border-white/20 text-white text-[10px] uppercase tracking-[0.2em] hover:border-gold-400 hover:text-gold-400 transition duration-500 ease-out">
                    Iniciar Tratativas
                </a>
            </div>

            <!-- Mobile: Hamburger -->
            <button id="mobileMenuBtn"
                    type="button"
                    class="lg:hidden inline-flex items-center justify-center w-11 h-11 border border-white/15 bg-white/5 backdrop-blur-sm hover:border-gold-400/40 transition"
                    onclick="toggleMobileMenu()"
                    aria-label="Abrir menu"
                    aria-controls="mobileMenu"
                    aria-expanded="false">
                <svg class="w-5 h-5 text-white/80" viewBox="0 0 24 24" fill="none" aria-hidden="true">
                    <path d="M4 7h16M4 12h16M4 17h16" stroke="currentColor" stroke-width="1.6" stroke-linecap="round"/>
                </svg>
            </button>
        </div>
    </nav>

    <!-- MOBILE MENU DRAWER -->
    <div id="mobileMenu" class="fixed inset-0 z-[110] hidden lg:hidden">
        <div class="absolute inset-0 bg-black/85 backdrop-blur-md" onclick="toggleMobileMenu(false)" aria-hidden="true"></div>

        <div class="absolute top-0 right-0 h-full w-[88%] max-w-sm bg-black/90 border-l border-white/10 p-6 overflow-y-auto drawer-enter">
            <div class="flex items-center justify-between pb-6 border-b border-white/10">
                <span class="font-serif text-base tracking-[0.15em] text-white uppercase">Menu</span>
                <button type="button"
                        class="text-neutral-400 hover:text-gold-400 transition-colors text-3xl leading-none"
                        onclick="toggleMobileMenu(false)"
                        aria-label="Fechar menu">✕</button>
            </div>

            <div class="pt-6 space-y-2 text-[11px] tracking-[0.25em] uppercase font-light">
                <a href="index.html" onclick="toggleMobileMenu(false)" class="block py-4 border-b border-white/10 text-neutral-300 hover:text-gold-400 transition">Início</a>
                <a href="origem.html" onclick="toggleMobileMenu(false)" class="block py-4 border-b border-white/10 text-neutral-300 hover:text-gold-400 transition">Origem</a>
                <a href="manifesto.html" onclick="toggleMobileMenu(false)" class="block py-4 border-b border-white/10 text-neutral-300 hover:text-gold-400 transition">Manifesto</a>

                <a href="licenciamento.html" onclick="toggleMobileMenu(false)" class="block py-4 border-b border-white/10 text-gold-400">Licenciamento</a>

                <a href="projetos-consultoria.html" onclick="toggleMobileMenu(false)" class="block py-4 border-b border-white/10 text-neutral-300 hover:text-gold-400 transition">Projetos &amp; Consultoria</a>
                <a href="acervo-executivo.html" onclick="toggleMobileMenu(false)" class="block py-4 border-b border-white/10 text-neutral-300 hover:text-gold-400 transition">Acervo Executivo</a>
                <a href="iniciar-tratativas.html" onclick="toggleMobileMenu(false)" class="block py-4 border-b border-white/10 text-neutral-300 hover:text-gold-400 transition">Contato</a>
            </div>

            <div class="pt-8">
                <div class="flex items-center justify-between text-[10px] uppercase tracking-widest">
                    <span class="text-gold-400">PT</span>
                    <a href="como-funciona-en.html" onclick="toggleMobileMenu(false)" class="text-neutral-500 hover:text-white transition" lang="en">EN</a>
                </div>

                <a href="iniciar-tratativas.html"
                   onclick="toggleMobileMenu(false)"
                   class="mt-6 block w-full px-6 py-4 border border-white/20 text-white text-[10px] uppercase tracking-[0.2em] hover:border-gold-400 hover:text-gold-400 transition duration-500 ease-out text-center">
                    Iniciar Tratativas
                </a>
            </div>

            <div class="pt-8 text-[10px] tracking-[0.25em] uppercase text-neutral-600">
                <span class="text-gold-400/80">BMIP</span> · Navegação Mobile
            </div>
        </div>
    </div>

    <main id="main-content" class="flex-grow pt-40 pb-32 px-6">
        <header class="max-w-4xl mx-auto text-center mb-24 animate-fade-up">
            <span class="text-gold-400 text-[10px] tracking-[0.4em] uppercase block mb-6 font-medium">Fluxo de Ponta a Ponta</span>
            <h1 class="font-serif text-5xl md:text-8xl text-white mb-8 italic">Como <span class="text-neutral-500 not-italic">Funciona</span></h1>
            <p class="text-neutral-400 font-light max-w-2xl mx-auto text-lg leading-relaxed">
                Licenciamento por sprints: entregáveis + treinamento + aplicação + revisão. Um sistema replicável — não consultoria por hora.
            </p>
            <p class="text-neutral-600 text-xs mt-6 tracking-widest uppercase">
                Clique em uma etapa para ver detalhes.
            </p>
        </header>

        <section class="max-w-6xl mx-auto roadmap-container pb-20">
            <div class="roadmap-line hidden md:block" aria-hidden="true"></div>

            <div class="space-y-24">

                <!-- I -->
                <div class="flex flex-col md:flex-row items-center justify-between gap-8 md:gap-16 step-group">
                    <div class="md:w-5/12 text-right hidden md:block opacity-10 group-hover:opacity-20 transition duration-500">
                        <span class="text-white font-serif text-8xl italic select-none">01</span>
                    </div>

                    <div class="step-number-badge" aria-hidden="true">I</div>

                    <button type="button"
                            class="md:w-5/12 w-full glass-panel p-10 md:p-12 text-left relative overflow-hidden group step-card"
                            data-step="I"
                            aria-haspopup="dialog"
                            aria-label="Abrir detalhes da etapa I: Protocolo de Iniciação">
                        <div class="absolute inset-0 bg-gold-400/5 translate-x-full group-hover:translate-x-0 transition duration-500"></div>
                        <h3 class="font-serif text-2xl md:text-3xl text-white mb-3 italic relative z-10 group-hover:text-gold-400 transition">Protocolo de Iniciação</h3>
                        <p class="text-neutral-400 text-sm font-light relative z-10">NDA + briefing.</p>
                        <span class="step-cta relative z-10">
                            <span class="step-cta-line"></span> Ver detalhes +
                        </span>
                    </button>
                </div>

                <!-- II -->
                <div class="flex flex-col md:flex-row-reverse items-center justify-between gap-8 md:gap-16 step-group">
                    <div class="md:w-5/12 text-left hidden md:block opacity-10 group-hover:opacity-20 transition duration-500">
                        <span class="text-white font-serif text-8xl italic select-none">02</span>
                    </div>

                    <div class="step-number-badge" aria-hidden="true">II</div>

                    <button type="button"
                            class="md:w-5/12 w-full glass-panel p-10 md:p-12 md:text-right relative overflow-hidden group step-card"
                            data-step="II"
                            aria-haspopup="dialog"
                            aria-label="Abrir detalhes da etapa II: Diagnóstico e Escopo">
                        <div class="absolute inset-0 bg-gold-400/5 -translate-x-full group-hover:translate-x-0 transition duration-500"></div>
                        <h3 class="font-serif text-2xl md:text-3xl text-white mb-3 italic relative z-10 group-hover:text-gold-400 transition">Diagnóstico e Escopo</h3>
                        <p class="text-neutral-400 text-sm font-light relative z-10">Mapeamento e prioridades.</p>
                        <span class="step-cta relative z-10">
                            <span class="step-cta-line"></span> Ver detalhes +
                        </span>
                    </button>
                </div>

                <!-- III -->
                <div class="flex flex-col md:flex-row items-center justify-between gap-8 md:gap-16 step-group">
                    <div class="md:w-5/12 text-right hidden md:block opacity-10 group-hover:opacity-20 transition duration-500">
                        <span class="text-white font-serif text-8xl italic select-none">03</span>
                    </div>

                    <div class="step-number-badge" aria-hidden="true">III</div>

                    <button type="button"
                            class="md:w-5/12 w-full glass-panel p-10 md:p-12 text-left relative overflow-hidden group step-card"
                            data-step="III"
                            aria-haspopup="dialog"
                            aria-label="Abrir detalhes da etapa III: Contrato + Setup">
                        <div class="absolute inset-0 bg-gold-400/5 translate-x-full group-hover:translate-x-0 transition duration-500"></div>
                        <h3 class="font-serif text-2xl md:text-3xl text-white mb-3 italic relative z-10 group-hover:text-gold-400 transition">Contrato + Setup</h3>
                        <p class="text-neutral-400 text-sm font-light relative z-10">Governança de marca, calendário e plano.</p>
                        <span class="step-cta relative z-10">
                            <span class="step-cta-line"></span> Ver detalhes +
                        </span>
                    </button>
                </div>

                <!-- IV -->
                <div class="flex flex-col md:flex-row-reverse items-center justify-between gap-8 md:gap-16 step-group">
                    <div class="md:w-5/12 text-left hidden md:block opacity-10 group-hover:opacity-20 transition duration-500">
                        <span class="text-white font-serif text-8xl italic select-none">04</span>
                    </div>

                    <div class="step-number-badge" aria-hidden="true">IV</div>

                    <button type="button"
                            class="md:w-5/12 w-full glass-panel p-10 md:p-12 md:text-right relative overflow-hidden group step-card"
                            data-step="IV"
                            aria-haspopup="dialog"
                            aria-label="Abrir detalhes da etapa IV: Implantação por Sprints">
                        <div class="absolute inset-0 bg-gold-400/5 -translate-x-full group-hover:translate-x-0 transition duration-500"></div>
                        <h3 class="font-serif text-2xl md:text-3xl text-white mb-3 italic relative z-10 group-hover:text-gold-400 transition">Implantação por Sprints</h3>
                        <p class="text-neutral-400 text-sm font-light relative z-10">Entrega aplicada + treino + ajustes.</p>
                        <span class="step-cta relative z-10">
                            <span class="step-cta-line"></span> Ver detalhes +
                        </span>
                    </button>
                </div>

                <!-- V -->
                <div class="flex flex-col md:flex-row items-center justify-between gap-8 md:gap-16 step-group">
                    <div class="md:w-5/12 text-right hidden md:block opacity-10 group-hover:opacity-20 transition duration-500">
                        <span class="text-white font-serif text-8xl italic select-none">05</span>
                    </div>

                    <div class="step-number-badge" aria-hidden="true">V</div>

                    <button type="button"
                            class="md:w-5/12 w-full glass-panel p-10 md:p-12 text-left relative overflow-hidden group step-card"
                            data-step="V"
                            aria-haspopup="dialog"
                            aria-label="Abrir detalhes da etapa V: Homologação e Kit">
                        <div class="absolute inset-0 bg-gold-400/5 translate-x-full group-hover:translate-x-0 transition duration-500"></div>
                        <h3 class="font-serif text-2xl md:text-3xl text-white mb-3 italic relative z-10 group-hover:text-gold-400 transition">Homologação e Kit</h3>
                        <p class="text-neutral-400 text-sm font-light relative z-10">Rotinas, checklists e métricas de sustentação.</p>
                        <span class="step-cta relative z-10">
                            <span class="step-cta-line"></span> Ver detalhes +
                        </span>
                    </button>
                </div>

                <!-- VI -->
                <div class="flex flex-col md:flex-row-reverse items-center justify-between gap-8 md:gap-16 step-group">
                    <div class="md:w-5/12 text-left hidden md:block opacity-10 group-hover:opacity-20 transition duration-500">
                        <span class="text-white font-serif text-8xl italic select-none">06</span>
                    </div>

                    <div class="step-number-badge" aria-hidden="true">VI</div>

                    <button type="button"
                            class="md:w-5/12 w-full glass-panel p-10 md:p-12 md:text-right relative overflow-hidden group step-card"
                            data-step="VI"
                            aria-haspopup="dialog"
                            aria-label="Abrir detalhes da etapa VI: Operação Assistida">
                        <div class="absolute inset-0 bg-gold-400/5 -translate-x-full group-hover:translate-x-0 transition duration-500"></div>
                        <h3 class="font-serif text-2xl md:text-3xl text-white mb-3 italic relative z-10 group-hover:text-gold-400 transition">Operação Assistida</h3>
                        <p class="text-neutral-400 text-sm font-light relative z-10">Suporte e evolução (conforme plano).</p>
                        <span class="step-cta relative z-10">
                            <span class="step-cta-line"></span> Ver detalhes +
                        </span>
                    </button>
                </div>

                <!-- VII -->
                <div class="flex flex-col md:flex-row items-center justify-between gap-8 md:gap-16 step-group">
                    <div class="md:w-5/12 text-right hidden md:block opacity-10 group-hover:opacity-20 transition duration-500">
                        <span class="text-white font-serif text-8xl italic select-none">07</span>
                    </div>

                    <div class="step-number-badge" aria-hidden="true">VII</div>

                    <button type="button"
                            class="md:w-5/12 w-full glass-panel p-10 md:p-12 text-left relative overflow-hidden group step-card"
                            data-step="VII"
                            aria-haspopup="dialog"
                            aria-label="Abrir detalhes da etapa VII: Renovação">
                        <div class="absolute inset-0 bg-gold-400/5 translate-x-full group-hover:translate-x-0 transition duration-500"></div>
                        <h3 class="font-serif text-2xl md:text-3xl text-white mb-3 italic relative z-10 group-hover:text-gold-400 transition">Renovação</h3>
                        <p class="text-neutral-400 text-sm font-light relative z-10">Manutenção anual do padrão e recertificação.</p>
                        <span class="step-cta relative z-10">
                            <span class="step-cta-line"></span> Ver detalhes +
                        </span>
                    </button>
                </div>

            </div>
        </section>

        <section class="max-w-4xl mx-auto text-center border-t border-white/5 pt-24 pb-12">
            <h2 class="font-serif text-3xl md:text-4xl text-white italic mb-6">Pronto para começar?</h2>
            <p class="text-neutral-500 text-sm font-light mb-10 max-w-xl mx-auto">
                Transforme processos em patrimônio. A primeira etapa é o alinhamento de expectativas.
            </p>
            <a href="iniciar-tratativas.html" class="inline-block px-10 py-4 bg-gold-400 text-black text-xs font-bold uppercase tracking-[0.25em] hover:bg-white transition duration-300">
                Iniciar Tratativas
            </a>
        </section>
    </main>

    <!-- MODAL: ETAPAS I–VII -->
    <div id="step-modal-overlay"
         class="fixed inset-0 bg-black/95 backdrop-blur-md z-[130] hidden items-start sm:items-center justify-center p-4 sm:p-8 overflow-y-auto overscroll-contain modal-enter"
         aria-hidden="true">

        <div id="step-modal"
             role="dialog"
             aria-modal="true"
             aria-labelledby="step-modal-title"
             class="bg-neutral-900/95 border border-gold-400/20 max-w-3xl w-full p-8 md:p-12 relative shadow-2xl flex flex-col
                    max-h-[calc(100vh-2rem)] sm:max-h-[calc(100vh-4rem)] overflow-hidden">

            <button id="step-modal-close"
                    type="button"
                    class="absolute top-6 right-6 text-neutral-500 hover:text-gold-400 transition-colors text-3xl font-light"
                    aria-label="Fechar Modal">✕</button>

            <div class="space-y-2 mb-8 border-l-2 border-gold-400 pl-6">
                <div class="text-gold-400 text-[10px] uppercase tracking-[0.35em] font-bold" id="step-modal-kicker"></div>
                <h3 id="step-modal-title" class="font-serif text-3xl md:text-4xl text-white leading-tight italic"></h3>
                <p id="step-modal-subtitle" class="text-neutral-400 text-sm font-light"></p>
            </div>

            <div id="step-modal-body" class="space-y-6 flex-1 min-h-0 overflow-y-auto pr-3 -mr-3"></div>

            <div class="pt-8 flex flex-col sm:flex-row gap-4 justify-end border-t border-white/5 mt-8 shrink-0">
                <button id="step-modal-back"
                        type="button"
                        class="px-8 py-3 border border-white/10 text-neutral-400 text-[10px] uppercase tracking-widest hover:border-gold-400 hover:text-gold-400 transition">
                    Voltar
                </button>
                <a href="iniciar-tratativas.html"
                   class="px-8 py-3 bg-gold-400 text-black text-[10px] uppercase tracking-widest font-bold hover:bg-white transition text-center">
                    Iniciar Tratativas
                </a>
            </div>
        </div>
    </div>

    <footer class="bg-black py-12 border-t border-white/5 text-[9px] text-neutral-700 text-center uppercase tracking-[0.2em] mt-auto">
        <div class="flex flex-col items-center gap-6">
            <img src="bmip-logo-dark.png" alt="Boutique Method IP Holding" class="h-8 w-auto opacity-60 hover:opacity-100 transition duration-500 select-none">
            <div class="space-y-2">
                <p>Boutique Method IP Holding Ltda © 2026</p>
                <p class="text-neutral-600">ceo@boutiquemethodip.com • (55) 98466-6591</p>
            </div>
        </div>
    </footer>

    <button id="globalAudioBtn" class="audio-fab paused" onclick="toggleAudioDescription()" aria-label="Ouvir conteúdo">
        <div class="audio-wave">
            <div class="bar"></div>
            <div class="bar"></div>
            <div class="bar"></div>
        </div>
        <span id="audioLabel" class="text-[9px] uppercase tracking-widest text-gold-400 font-bold">Ouvir Página</span>
    </button>

    <script src="accessibility.js"></script>

    <script>
        // --- NAV MOBILE ---
        let mobileMenuOpen = false;

        function toggleMobileMenu(force) {
            const menu = document.getElementById('mobileMenu');
            const btn = document.getElementById('mobileMenuBtn');

            mobileMenuOpen = (typeof force === 'boolean') ? force : !mobileMenuOpen;

            if (mobileMenuOpen) {
                menu.classList.remove('hidden');
                document.body.style.overflow = 'hidden';
                btn.setAttribute('aria-expanded', 'true');
            } else {
                menu.classList.add('hidden');
                document.body.style.overflow = 'auto';
                btn.setAttribute('aria-expanded', 'false');
            }
        }

        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') {
                if (mobileMenuOpen) toggleMobileMenu(false);
            }
        });

        // --- MODAL: ETAPAS ---
        const stepModalData = {
            I: {
                kicker: "Etapa I",
                title: "Protocolo de Iniciação",
                subtitle: "NDA + briefing.",
                what: "Abertura formal do protocolo BMIP. Protege, enquadra e define o mínimo necessário para diagnóstico sem ruído.",
                entrada: [
                    "NDA (quando aplicável) e responsáveis por aprovação",
                    "Briefing inicial (objetivo, contexto, canais e público)",
                    "Amostras do padrão atual (mensagens/e-mails/fluxos)"
                ],
                saida: [
                    "Triagem de elegibilidade e enquadramento (licenciamento x projeto x acervo)",
                    "Pré-escopo do diagnóstico e próximos passos",
                    "Agenda de diagnóstico (quando aplicável)"
                ],
                criterio: "Escopo do diagnóstico validado e autorizado."
            },
            II: {
                kicker: "Etapa II",
                title: "Diagnóstico e Escopo",
                subtitle: "Mapeamento e prioridades.",
                what: "Mapeamento do estado atual e definição do que entra primeiro. Aqui nascem prioridades, riscos e o backlog por sprints.",
                entrada: [
                    "Mapa de canais (WhatsApp, e-mail, social, presencial)",
                    "Regras internas e pontos de risco (jurídico/reputação)",
                    "Volume, gargalos e fricções recorrentes"
                ],
                saida: [
                    "Diagnóstico com prioridades e ordem de implantação",
                    "Backlog do método (o que vira template, SOP, script, regra)",
                    "Proposta de sprints (fases e critérios de validação)"
                ],
                criterio: "Backlog do método aprovado com ordem de execução."
            },
            III: {
                kicker: "Etapa III",
                title: "Contrato + Setup",
                subtitle: "Governança de marca, calendário e plano.",
                what: "Formalização e preparação do ambiente de execução. Define papéis, rituais e a disciplina mínima para implantar sem travar.",
                entrada: [
                    "Dados para contrato/licenciamento e pontos de contato",
                    "Ferramentas e acessos (Drive/Notion/CRM, quando aplicável)",
                    "Responsáveis por validação e publicação"
                ],
                saida: [
                    "Governança de marca e uso (regras, limites e aprovações)",
                    "Calendário de sprints e checkpoints",
                    "Estrutura mínima de rotinas (semanal/mensal) para sustentação"
                ],
                criterio: "Ambiente pronto e governança definida para implantar."
            },
            IV: {
                kicker: "Etapa IV",
                title: "Implantação por Sprints",
                subtitle: "Entrega aplicada + treino + ajustes.",
                what: "Execução em ciclos curtos: entregáveis, treinamento, aplicação real e revisão. O padrão vira operação, não slide.",
                entrada: [
                    "Participação mínima do time nas revisões e treinos",
                    "Feedback de casos reais (o que funcionou / travou / gerou risco)",
                    "Aprovação rápida de itens críticos"
                ],
                saida: [
                    "Templates, scripts e SOPs implantados em operação real",
                    "Treinamento orientado ao uso (quando / como / por quê)",
                    "Ajustes finos com base em aplicação sob pressão"
                ],
                criterio: "Padrão operável sem improviso recorrente."
            },
            V: {
                kicker: "Etapa V",
                title: "Homologação e Kit",
                subtitle: "Rotinas, checklists e métricas de sustentação.",
                what: "Fechamento técnico do que foi implantado e empacotamento do sistema. Consolida versões, rotinas e métricas mínimas.",
                entrada: [
                    "Validação final do que fica e do que será ampliado depois",
                    "Revisão de versão e consistência (tom, forma e limites)",
                    "Alinhamento de donos do processo (quem mantém o padrão)"
                ],
                saida: [
                    "Kit operacional (checklists, rotinas e regras de uso)",
                    "Métricas mínimas e critérios de qualidade",
                    "Controle de versões e trilha de atualização"
                ],
                criterio: "Kit homologado e pronto para sustentação."
            },
            VI: {
                kicker: "Etapa VI",
                title: "Operação Assistida",
                subtitle: "Suporte e evolução (conforme plano).",
                what: "Sustentação guiada para manter o nível e evoluir sem quebrar a identidade. Corrige, refina e expande com controle.",
                entrada: [
                    "Sinais de operação (retrabalho, falhas críticas, dúvidas recorrentes)",
                    "Feedback do time e do cliente sobre pontos de atrito",
                    "Casos sensíveis para calibração do padrão"
                ],
                saida: [
                    "Correções e refinamentos (scripts, negativas, escalonamento)",
                    "Expansão controlada por prioridade (sem inflar o sistema)",
                    "Rituais de governança aplicados (semanal/mensal)"
                ],
                criterio: "Operação estável com governança ativa."
            },
            VII: {
                kicker: "Etapa VII",
                title: "Renovação",
                subtitle: "Manutenção anual do padrão e recertificação.",
                what: "Recertificação e atualização do método para novas fases, equipes, riscos e posicionamento. Mantém padrão vivo e auditável.",
                entrada: [
                    "Mudanças internas (processos, equipe, canais, risco)",
                    "Aprendizados do ciclo (o que consolidar e o que substituir)",
                    "Novas prioridades e objetivos do próximo período"
                ],
                saida: [
                    "Atualização do kit, versões e regras",
                    "Recertificação do padrão e revalidação de governança",
                    "Roadmap do próximo ciclo (sprints futuros)"
                ],
                criterio: "Padrão atualizado e revalidado institucionalmente."
            }
        };

        const overlay = document.getElementById('step-modal-overlay');
        const closeBtn = document.getElementById('step-modal-close');
        const backBtn = document.getElementById('step-modal-back');
        const kickerEl = document.getElementById('step-modal-kicker');
        const titleEl = document.getElementById('step-modal-title');
        const subtitleEl = document.getElementById('step-modal-subtitle');
        const bodyEl = document.getElementById('step-modal-body');
        const modalEl = document.getElementById('step-modal');

        let lastFocusedEl = null;

        function renderSection(label, contentHtml) {
            return `
                <div class="space-y-2">
                    <div class="text-[10px] uppercase tracking-[0.35em] text-neutral-500">${label}</div>
                    ${contentHtml}
                </div>
            `;
        }

        function renderList(items) {
            const li = items.map(x => `
                <li class="flex items-start gap-3">
                    <span class="text-gold-400 mt-1 text-xs">✦</span>
                    <span class="text-neutral-300 font-light text-sm leading-relaxed">${x}</span>
                </li>
            `).join("");
            return `<ul class="space-y-3">${li}</ul>`;
        }

        function openStepModal(stepKey) {
            const data = stepModalData[stepKey];
            if (!data) return;

            lastFocusedEl = document.activeElement;

            kickerEl.textContent = data.kicker;
            titleEl.textContent = data.title;
            subtitleEl.textContent = data.subtitle;

            const html = [
                renderSection("O que é", `<p class="text-neutral-300 font-light text-base leading-relaxed">${data.what}</p>`),
                renderSection("Entrada", renderList(data.entrada)),
                renderSection("Saída", renderList(data.saida)),
                renderSection("Critério de conclusão", `<p class="text-neutral-400 font-light text-sm leading-relaxed">${data.criterio}</p>`)
            ].join("");

            bodyEl.innerHTML = html;

            overlay.classList.remove('hidden');
            overlay.classList.add('flex');
            overlay.setAttribute('aria-hidden', 'false');
            document.body.style.overflow = 'hidden';

            // foco
            setTimeout(() => closeBtn.focus(), 0);
        }

        function closeStepModal() {
            overlay.classList.add('hidden');
            overlay.classList.remove('flex');
            overlay.setAttribute('aria-hidden', 'true');
            document.body.style.overflow = mobileMenuOpen ? 'hidden' : 'auto';

            if (lastFocusedEl && typeof lastFocusedEl.focus === 'function') {
                setTimeout(() => lastFocusedEl.focus(), 0);
            }
        }

        // Clique nos cards
        document.querySelectorAll('.step-card').forEach(btn => {
            btn.addEventListener('click', () => openStepModal(btn.dataset.step));
            btn.addEventListener('keydown', (e) => {
                if (e.key === 'Enter' || e.key === ' ') {
                    e.preventDefault();
                    openStepModal(btn.dataset.step);
                }
            });
        });

        // Botões modal
        closeBtn.addEventListener('click', closeStepModal);
        backBtn.addEventListener('click', closeStepModal);

        // Clique fora fecha
        overlay.addEventListener('click', function(e) {
            if (e.target === overlay) closeStepModal();
        });

        // ESC fecha + trap de foco simples
        document.addEventListener('keydown', function(e) {
            const isOpen = overlay.classList.contains('flex');
            if (!isOpen) return;

            if (e.key === 'Escape') {
                closeStepModal();
                return;
            }

            if (e.key === 'Tab') {
                const focusables = modalEl.querySelectorAll(
                    'button, a[href], textarea, input, select, [tabindex]:not([tabindex="-1"])'
                );
                if (!focusables.length) return;

                const first = focusables[0];
                const last = focusables[focusables.length - 1];

                if (e.shiftKey && document.activeElement === first) {
                    e.preventDefault();
                    last.focus();
                } else if (!e.shiftKey && document.activeElement === last) {
                    e.preventDefault();
                    first.focus();
                }
            }
        });

        // Áudio Descrição
        const synth = window.speechSynthesis;
        let isPlaying = false;

        function toggleAudioDescription() {
            const btn = document.getElementById('globalAudioBtn');
            const label = document.getElementById('audioLabel');

            if (isPlaying) {
                synth.cancel();
                isPlaying = false;
                btn.classList.add('paused');
                label.innerText = "Ouvir Página";
            } else {
                const text = "Como Funciona. Licenciamento por sprints: entregáveis, treinamento, aplicação e revisão. Clique em uma etapa para ver detalhes. Etapas: 1. Protocolo de Iniciação. 2. Diagnóstico e Escopo. 3. Contrato e Setup. 4. Implantação por Sprints. 5. Homologação e Kit de Sustentação. 6. Operação Assistida. 7. Renovação e Recertificação.";
                const utter = new SpeechSynthesisUtterance(text);
                utter.lang = 'pt-BR';
                utter.rate = 0.95;

                utter.onend = () => {
                    isPlaying = false;
                    btn.classList.add('paused');
                    label.innerText = "Ouvir Página";
                };

                synth.speak(utter);
                isPlaying = true;
                btn.classList.remove('paused');
                label.innerText = "Parar Áudio";
            }
        }
    </script>
</body>
</html>
